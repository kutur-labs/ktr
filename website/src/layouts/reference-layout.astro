---
import Head from "./head.astro";
import ThemeSwitcher from "../components/theme-switcher.astro";

interface TocItem {
  depth: number;
  slug: string;
  text: string;
}

interface Props {
  toc: TocItem[];
}

const { toc } = Astro.props;
---

<html lang="en">
  <head>
    <Head title="Reference - ktr" />
  </head>
  <body>
    <header
      class="sticky top-0 z-10 h-14 md:h-16 bg-background border-b border-border"
    >
      <nav class="h-full flex items-end justify-between py-2 md:py-3 px-4">
        <a
          href="/"
          class="max-w-min text-primary hover:text-primary/70 active:text-primary/70 focus:text-primary/70"
        >
          <h1 class="text-3xl md:text-4xl font-display leading-[0.92]">ktr</h1>
        </a>

        <ul class="h-full flex items-end gap-3 md:gap-4">
          <li>
            <ThemeSwitcher />
          </li>

          <li>
            <a
              href="https://github.com/kutur-labs/ktr"
              target="_blank"
              class="flex items-center -translate-y-[0.3rem] text-primary-muted-foreground hover:text-primary-muted-foreground/70 active:text-primary-muted-foreground/70 focus:text-primary-muted-foreground/70"
              aria-label="GitHub"
            >
              <svg
                class="size-[0.85rem] md:size-[0.91rem]"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"
                ></path>
              </svg>
            </a>
          </li>

          <li class="mr-4">
            <a
              href="https://discord.com/channels/1469502544559476987/1469502546401038420"
              target="_blank"
              class="flex items-center -translate-y-[0.3rem] text-primary-muted-foreground hover:text-primary-muted-foreground/70 active:text-primary-muted-foreground/70 focus:text-primary-muted-foreground/70"
              aria-label="Discord"
            >
              <svg
                class="size-[0.85rem] md:size-[0.91rem]"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.947 2.418-2.157 2.418z"
                ></path>
              </svg>
            </a>
          </li>

          <li>
            <a
              href="/playground"
              class="text-xs md:text-sm text-primary-muted-foreground hover:text-primary-muted-foreground/70 active:text-primary-muted-foreground/70 focus:text-primary-muted-foreground/70"
              >Playground</a
            >
          </li>

          <li>
            <a
              href="/reference"
              class="text-xs md:text-sm text-primary-muted-foreground hover:text-primary-muted-foreground/70 active:text-primary-muted-foreground/70 focus:text-primary-muted-foreground/70"
              >Reference</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <div class="flex flex-col md:flex-row">
      <aside
        class="sticky top-14 md:top-16 z-10 bg-background border-b md:border-b-0 md:border-r border-border overflow-x-auto md:overflow-y-auto md:h-[calc(100vh-4rem)] w-full md:w-52 shrink-0 py-2 px-4 md:py-3"
      >
        <nav
          class="flex flex-row md:flex-col gap-3 md:gap-0.5 text-sm whitespace-nowrap md:whitespace-normal"
        >
          {
            toc.map((item) => (
              <a
                href={`#${item.slug}`}
                class:list={[
                  "text-foreground/70 hover:text-foreground py-0.5",
                  item.depth === 2 && "md:pl-3",
                  item.depth === 3 &&
                    "hidden md:block md:pl-6 text-foreground/50",
                ]}
              >
                {item.text}
              </a>
            ))
          }
        </nav>
      </aside>

      <main class="flex-1 min-w-0 py-6 px-4 md:py-8 md:px-8 prose">
        <slot />
      </main>
    </div>
  </body>
</html>

<style is:global>
  @reference "../styles/global.css";

  .prose h1 {
    @apply text-2xl font-normal mt-12 mb-4 pt-4 border-t border-border scroll-mt-28 md:scroll-mt-20;
  }
  .prose h1:first-child {
    @apply mt-0 pt-0 border-t-0;
  }
  .prose h2 {
    @apply text-xl font-normal mt-8 mb-3 scroll-mt-28 md:scroll-mt-20;
  }
  .prose h3 {
    @apply text-lg font-normal mt-6 mb-2 scroll-mt-28 md:scroll-mt-20;
  }
  .prose p {
    @apply my-3 text-foreground/80 leading-relaxed;
  }
  .prose code {
    @apply bg-foreground/10 px-1.5 py-0.5 rounded text-sm;
  }
  .prose pre {
    @apply bg-foreground/5 border border-border rounded-lg p-4 my-4 overflow-x-auto;
  }
  .prose pre code {
    @apply bg-transparent p-0 text-sm;
  }
  .prose strong {
    @apply font-normal;
  }
  .prose dl {
    @apply my-4;
  }
  .prose dt {
    @apply font-normal;
  }
  .prose dd {
    @apply ml-4 text-foreground/70 mb-2;
  }
  .prose ul {
    @apply my-3 pl-6 list-disc;
  }
  .prose ol {
    @apply my-3 pl-6 list-decimal;
  }
  .prose li {
    @apply my-1 text-foreground/80;
  }
  .prose li::marker {
    @apply text-foreground/40;
  }
  .prose table {
    @apply my-4 w-full text-sm border-collapse;
  }
  .prose th {
    @apply text-left font-normal text-foreground/60 border-b border-border pb-2 pr-4;
  }
  .prose td {
    @apply text-foreground/80 border-b border-border/50 py-1.5 pr-4;
  }
  .prose thead tr {
    @apply border-b border-border;
  }
</style>
